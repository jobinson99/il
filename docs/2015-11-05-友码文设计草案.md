---
layout: post
title: "爱码文设计草案"
date: 2014-11-05 13:29:59 +0800
categories: 说明
tags: [爱码文, 语言设计, 文本]
lastmod: 2018-06-18
---

说明：这是爱码文的设计草案。


状态含义： 待完成设计  ●完成 ■待测试 ◆被认领开发中 ★计划


格式后缀：il
可选：iml（iml is markup language） imt it(it is text 但it已有 脉冲跟踪系统音乐模块文件 使用)


**设计准则：**

- 参考 markdown，但 取消所有的缩进（比如代码块，列表），双行设计（比如主题），所有结构级的，全部用行首语法表示。
- 参考textile，orgmode 但 避免使用字母做标识。

- 尽可能少的标识符 `# | [ ] { } + - = > * / _ ^ ~ `` 1 2 3 4 5 6 7 8 9 0`

- 尽可能常用功能齐备

- 通用的起始和结束标志
- 要方便的加类名或者识别名
- 要方便的可加扩展，融合了mediawiki的表格语法。


关于嵌入html代码：
直接嵌入html，仅当普通文本，输出html后会被转码，想要原样输出，需要手动 把例外字符 转义。
如果是在 code里嵌入，不运行。
如果是在 pre里嵌入，根据是否设置 init，决定是否运行。

其他代码类似

## 行内 （内建实现功能）

- 加粗 ` *加粗* `  输出 `<b>加粗</b>`
- 斜体 ` /斜体/ `  输出 `<i>斜体</i>`
- 删除线 ` +删除线+ `  输出 `<s>删除线</s>`
- 下划线 ` _下划线_ `  输出 `<u>下划线</u>`
- 上标下标 ` ^上标^ ～下标～ `   输出 `<sup>上标</sup><sub>下标</sub>`
- 代码  ` \`代码\` `  输出 `<code>代码</code>`
- 行内嵌入其他代码，比如html
- 加标志：用于各种自定义  ` {mark| xxx} ` 比如 `<mark></mark>`
- 转义 ` \ `

参考：常用4个标识累赘了。
- markdown orgmode 需要2个符号标识
- textile 的 `[*文字*]` 需要4个符号标识，另一种方式是左右各一个空格 ` *文字* `
- restruedtext的  ` \* 文字*\ ` 需要4个符号标识
- asciidoc的 ` [效果定义]*文字* ` 比较通用，但需要4个符号标识，可用于自定义样式



可选设定：
```
左右无空格版
[*xxx*]
[/xxx/]
[+xxx+]
[_xxx_]
[-xxx-]  未使用
[=xxx=]  未使用
[^xxx^]
[~xxx~]
[`xxx yyy`]

这种需要输入5次
[* : ]
[/ : ]
[` : ]

带自动闭合，输入3次，不带5次
{*}[xxx]
{*[xxx]}
[*[xxx]]

此种好处是可多种样式互嵌
[[*][xxx]]
[[/][xxx]]

```

自定义行内样式：

有起始和终点标志，可以 **多个 嵌入**。

自定义行内样式和连接统一规则：
- 不显示的在前，显示的在后。
- 内容起始终结标记  多行引用，多行列表

```
[[类名][内容]]

输出：
<span class=""></span>
<span id=""></span>
锚点id用 #xxx ???不行，对应的连接也是如此


多种样式嵌入
[[类名 类名 类名][内容]]


内容里面再嵌入呢？
[[类名][内容[[嵌入类名][嵌入内容]]内容]]

```

可选自定义
```
 # # 
[类名| 内容 |]
[类名| 内容  ]
{类名| 内容 }
{类名[ 内容]}
[类名1|类名2| 内容|]
{类名 类名 类名 [内容]}

[类名 类名 | 内容]    优点是输入少了2个符号
[类名 类名 | 内容[嵌入类名 嵌入类名| 内容]内容]
[类名 类名 : 内容]

```

## [TODO]链接 （内建实现功能）

统一起来，外链，脚注，底注都是 链接。统一格式，在输出时才做区分。

- 外部链接 http://www.xxx.com
- 邮件链接 email://xxx@xxx.com
- 直显媒体：图，音频，视频等 http://www.xxx.com/xxx.jpg
- 站内链接  /xxx/
- 文内锚点：底注，边注，尾注 <a href="#xxx">锚点</a>，对应的 <span id="xxx"></span>

统一设定为：
```
[[链接地址][链接名]]      输出 <a href="链接地址">连接名</a>

[[http://www.xxx.com][xxx]]
[[/xxx][yyy]]                 输出 <a href="/xxx"></a>    和类分不开
[[>xxx][yyy]]                链接，可以和类分开，但多输了一个符号，总共要输入7个符号
[[dir/image.png][imagename]]   输出 <img alt="yyy" src="xxx">

[[#anchor][anchorname]]     <a href="#xxx"></a>
[[:anchor][anchor content]]  <span id="xxx"></span>
[[#1][footnote link]]       <a href="#1"></a>
[[:1][footnote content]]    <span id="1"></span>
```

参考：
```
[[链接名|链接地址]]
或
[[#直显媒体名#地址]]
[链接名](链接地址)
[[链接地址][链接名]]    orgmode
```
文内锚点：底注，边注，尾注
```
[[#锚点#|地址]] 内容     输出 <a href="#xxx"></a>
[[#锚点目标#|地址]] 内容   输出 <li id="#xxx"></li>

<<锚点>>
[fn:1] 尾注锚点
[[链接地址][链接名]]    orgmode
```
或 以空格分隔
```
[[http://地址 链接名]]
[[#站内# 话题名]]
[[^引用^ 地址]]
[[!直显媒体名字! 地址]]
```

可选：
```
[链接名| 链接地址]
[连接地址| 名|]


[地址 : 名]
[类名 : ]
[>链接 : ]    <a href=""></a>
[#引用 : ]    <a href="#xxx"></a>
[^页内连接 : ]   <span id="xxx"><span>
[! : ]            <img alt="" src="">

{地址}[内容]

```

如果编辑器或者输入法带自动闭合的话，需要输入3-4次。如果不带，需要6-7次。
如果采用简化方式，带自动闭合，需要4-5次，如果不带，需要5-6次。
markdown那种，带闭合，仅需2-3次，不带需4-5次



## 区块（内建实现）

标识全部在行首，且无缩进。

### 文档大纲 （内建实现功能）

- 一级 ` #1 `   输出 `<h1></h1>`
- 二级 ` #2 `   输出 `<h2></h2>`
- 三级 ` #3 `
- 四级 ` #4 `
- 五级 ` #5 `
- 六级 ` #6 `

如果带自动编号的标题呢？
```
#1+    h1 编号1    输出 <h1>1. </h1>
#1+    h1 编号2    输出 <h1>2.  </h1>
#1     h1
#1+    h1 编号3
```

参考：textile 优点是固定长度 ` h1. h2. h3 ` 。
不固定长度：markdown ` # ## ### ` orgmode  `* ** *** ` asciidoc ` = == === ` 。


### 段落 （内建实现功能）

空行当分段？ 输出 `<p></p>`

### 分隔线 （内建实现功能）

三短线，输出 `<hr>`

```
===
```

可选用
```
---   和列表 无序三级 `---` 互斥。
___
```

### 列表 （内建实现功能）

行首用 - 或 + 带空格，后跟文字。 `<ul><li> <ol><li>`

```
- 无序
-- 无序二级
+ 有序
++ 有序二级
```

混合

```
- 无序
-+ 无序 有序1
-++ 无序 有序 有序1
--+ 无序 无序 有序1
+ 有序1
++ 有序1 有序1
+- 有序1 无序
+-- 有序1 无序 无序
```

定义类列表？不必！可以在此列表基础上实现。


列表续行：续行不缩进，设置一个起始符和结束符

```
--[ 多行列表开始

另一行

--] 多行列表结束
```

列表中的代码块：代码块不缩进

```
--[ 列表行开始
\`\`\` 代码开始
代码
\`\`\` 代码结束
--]  列表行结束
```


### 引用块 （内建实现功能）
输出 `<blockquote></blockquote>`

```
> 一段引用

>[ 多行引用
引用文
>] 多行引用结束

>> 一段 二级引用

>>[ 多行二级引用开始
引用文
>>] 多行二级引用结束
```

参考：
markdown ` > >>`  比较繁琐，每行首都要加 `>`，
textile 行首 `bq. bq..  p.  ` ，比较灵活。


## [TODO]区块 ```可扩展

标识全部在行首，且无缩进。


```
\`\`\` 调用插件名
内容
\`\`\`
```
可加于任何行首？？？

插件名
类
:名
>highlight 是否高亮 默认原样。
>pretty 缩进整理，默认原样。
>init 是否运行，默认原样。


代码块是原样输出
头信息则是全文转码后产生的，前台不可见的。注释则是转码时删除。
其他的 插件，则是要运行的，比如表格、绘图、数学公式等。


自定义区块
```
\`\`\` custom xxx yyy :zzz
内容
\`\`\`

输出
<div id="zzz" class="xxx yyy"></div>

可以多个
```

可选：
```
[|类名:
|]

优点是输入少，且和 引用块，列表一致用 []做起始和终点标志
`[ 类名
`]

优点是 全局统一用  [] 作为起始和终点标志
[[[ 
]]]
```

### 代码块 （默认内建，但插件实现更多功能）
输出`<pre></pre>`

```
\`\`\` 代码名 是否高亮 是否缩进整理 是否运行
代码
\`\`\`
```

默认原样输出，这样就可以嵌入任何代码，不用指定代码名。

需要运行和高亮缩进整理的，插件实现。此部分参考orgmode。

参考：
- markdown gfm 的 ` ``` ~~~ `，orgmode的 `#+BEGIN_SRC elisp`
- textile 的行首 `bc.  p.  ` 或  ` pre. p. `



### [TODO]表格（插件实现）

参考 mediawiki的表格语法，本来可以 `[| |]` 但连接用到 `[ | ]` ，尤其是脚注和底注，会混淆？？？


也可沿用代码块设定：

```
\`\`\` table
表格代码
\`\`\`
```

可用格式

```
{[  表格开始
|-  表格间分割
|   表格单元内容
]}  表格结束
```

实例
```
{[
| 头1 | 头2|
|-
| 内容1 | 内容2 |
| 内容三
|- 下一行

]}
```

参考：

wiki

```
{|
|-
|}
```

textile
```
|_. head1 |_. head2 |_. head3 |
|/3. rowspan | cell  | cell |
|\2. colspan |
| cell | cell |
```
asciidoc
```
|============================
|1 |2 |3 |4
|5 2.2+|6 .3+|7
|8
|9 2+|10
|============================
```


### 绘图（插件实现）

比如流程图，脑图。

沿用代码块设定，调用相应的插件实现。

```
\``` graphv
绘图表达式
\`\`\`
```

svg，canvas等，也通过调用相关插件实现。


### 数学公式（插件实现）

沿用代码块设定，调用相应的插件实现。

```
\``` math
数学公式
\`\`\`
```

### 文件变量（插件实现）

可自由定义，取代一般markdown文件头的yaml信息。


设计可沿用代码块设定，调用相关插件实现。

```
\`\`\` meta
头信息
\`\`\`

输出 <head>……</head>
```

可选标识：header


参考 orgmode，如下形式：

```
#+xxx:yyy
#+title:标题
```

### 注释（插件实现）

无输出，或者输出 `<!--  -->`

设计可沿用代码块设定，调用相关插件实现。

```
\`\`\` comment
注释
\`\`\`
```

参考： orgmode 注释 `#+begin_example 多段注释 #+end_example`

### 其他结构性文本（插件实现）

设计都可沿用代码块设定，调用相关插件实现。



